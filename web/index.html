<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple yt-dlp GUI v1.0.1</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <!-- 頂部標題 -->
        <header>
            <h1>Simple yt-dlp GUI <span class="badge">v1.0.1</span></h1>
            <div class="header-controls">
                <button onclick="toggleSettings()" class="icon-btn">⚙️ 設定</button>
            </div>
        </header>

        <!-- 設定視窗 (預設隱藏) -->
        <div id="settingsPanel" class="settings-panel hidden">
            <h3>系統設定</h3>
            <div class="setting-row">
                <label>FFmpeg 路徑</label>
                <div class="input-with-btn">
                    <input type="text" id="cfg_ffmpeg" readonly>
                    <button onclick="browseFFmpeg()">瀏覽</button>
                </div>
            </div>
            <div class="setting-row">
                <label>預設下載目錄</label>
                <div class="input-with-btn">
                    <input type="text" id="cfg_output" readonly>
                    <button onclick="browseDir()">瀏覽</button>
                </div>
            </div>
            <button class="save-btn" onclick="saveSettings()">儲存並關閉</button>
        </div>

        <!-- 主操作區 -->
        <main>
            <!-- 輸入區 -->
            <div class="input-section">
                <input type="text" id="urlInput" placeholder="請貼上 Bilibili / Twitch / YouTube 網址..." oninput="analyzeLink()">
                <div id="platformBadge" class="platform-badge hidden">偵測中...</div>
            </div>

            <!-- 直播警告 -->
            <div id="liveWarning" class="warning-box hidden">
                ⚠️ 警告：偵測到此為直播連結。邊直播邊下載功能未經完整測試，可能會出現預期外的錯誤 (如檔案損毀或中斷)。
            </div>

            <!-- 選項區 (根據輸入自動展開) -->
            <div class="options-grid">
                <!-- 影片選項 -->
                <label class="option-card">
                    <input type="radio" name="downloadMode" value="video" checked onchange="toggleSubOptions()">
                    <div class="card-content">
                        <span class="icon">🎬</span>
                        <span class="title">下載影片</span>
                        <div class="sub-options" id="sub_video">
                            <select id="vid_quality">
                                <option value="best">最佳畫質</option>
                                <option value="4k">限制 4K</option>
                                <option value="1080">限制 1080p</option>
                                <option value="720">限制 720p</option>
                            </select>
                            <label><input type="checkbox" id="vid_embed_cover" checked> 內嵌封面</label>
                            <label><input type="checkbox" id="vid_embed_meta" checked> 內嵌資訊</label>
                        </div>
                    </div>
                </label>

                <!-- 音訊選項 -->
                <label class="option-card">
                    <input type="radio" name="downloadMode" value="audio" onchange="toggleSubOptions()">
                    <div class="card-content">
                        <span class="icon">🎵</span>
                        <span class="title">純音訊</span>
                        <div class="sub-options hidden" id="sub_audio">
                            <select id="aud_bitrate">
                                <option value="320">320 kbps</option>
                                <option value="192" selected>192 kbps</option>
                                <option value="128">128 kbps</option>
                            </select>
                            <label><input type="checkbox" id="aud_embed_cover" checked> 內嵌封面</label>
                            <label><input type="checkbox" id="aud_embed_meta" checked> 內嵌資訊</label>
                        </div>
                    </div>
                </label>

                <!-- 封面選項 -->
                <label class="option-card">
                    <input type="radio" name="downloadMode" value="cover" onchange="toggleSubOptions()">
                    <div class="card-content">
                        <span class="icon">🖼️</span>
                        <span class="title">純封面</span>
                        <div class="desc">僅下載 JPG/PNG</div>
                    </div>
                </label>

                <!-- Metadata選項 -->
                <label class="option-card">
                    <input type="radio" name="downloadMode" value="metadata" onchange="toggleSubOptions()">
                    <div class="card-content">
                        <span class="icon">📄</span>
                        <span class="title">純 Metadata</span>
                        <div class="desc">下載 JSON 資訊</div>
                    </div>
                </label>
            </div>

            <!-- 執行按鈕 -->
            <button class="action-btn" onclick="startDownload()">開始處理</button>

            <!-- 進度與日誌 -->
            <div class="status-panel">
                <div class="progress-bar-container">
                    <div id="progressBar" class="progress-bar"></div>
                </div>
                <div class="status-text">
                    <span id="statusMsg">等待任務...</span>
                    <span id="percentNum">0%</span>
                </div>
                <div id="logConsole" class="log-console"></div>
            </div>
        </main>
    </div>
    <script type="text/javascript" src="/eel.js"></script>
    <script src="script.js"></script>
</body>
</html>
